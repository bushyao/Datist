浏览报告
=====================
科学研究是一项极为复杂的工作，研究中要完成一系列的任务，每个任务都会产若干图表。任务可对应于数据专家的流程，使用浏览报告节点可将多个流程产生的图表汇集成一份完整的报告。

浏览报告采MarkDown技术，遵循MarkDown基本语法，参考 https://en.wikipedia.org/wiki/Markdown 。

数据专家独有的语法：

$$节点名$  代表当前节点的名称；

$$文件名$  代表流程的文件名；

$$标题$	   代表流程的标题；

$$作者$    代表流程的创建人名称；

$$版本$    代表的程的版本号；

$$摘要$    代表流程的描述；

$NodeName$     代表前节点的内容,其中NodeName为数据流中，Name字段数据项的内容。

.. note::
   浏览节点，前节点输出数据流中，必须有ID、Name、StreamType和Data字段，Description（可选）。
   
   一般情况，用户可以借助于文件收集器，将前面节点的文字、表格、图片打包后，再输入到浏览报告节点，以便生成报告。


浏览报告节点详情
-----------------

**1) 标记页**
系统支持三种报告生成方式，自动创建报告、文件模板、自定义标记三种方式；

  **自动创建报告：** 使用系统提供的默认标记生成报告，默认选中。

    * 标题（$）：勾选显示，可自定义设置报告标题，报告标题支持流程变量；不勾选则不显示标题。

    * Name：定义数据表Name的显示方式，包括：显示为子标题，显示为文字、不显示。

    * Description：勾选，输出为段落内容；不勾选，则不输出。

    * Data：勾选，输出数据表中的图片；不勾选，则不输出。

    * 题注：勾选显示，在输出图表的同时输出图表的题注文字，可以在下拉框中指定题注的字段名称；不勾选，则不输出。
   
    * 创建默认自定义标记：自动创建自定义标记，并将自定义标记单选框置于激活状态；
   
  **文件模板：**  用户可指定HTML模板文件生成报告。
   
  **自定义标记：** 提供用户录入MarkDown标记的入口，用于创建用户特有数据分析报告。

    * 图片类型：$事件统计(width=400,height=400)$，可支持多个image标签的原生HTML语法；
   
    * 表格类型：$具体数据(autoid=false,expend=true,years.decimal=5)$，autoid定义是否自动追加编号列，默认若表中没有编号列自动追加；expend定义表格是否展开，默认大于20行收缩；years.decimal指定数据列的小数点位数，其中years为的列名；

**2) 样式设置页**

定义报告中标题级别、编号样式、图像宽度等基本样式。

  **输出流程格式：** 定义在流程收集模式下，报告的输出格式，支持html、doc、docx、pdf和HTML_TAG（默认）格式。

  **标题级别：** 定义报告中标题的级别；

  **图像最大宽度：** 限定图像的最大宽度；

  **页面宽度：** 定义报告的页面宽度；
  
  **超过50行收缩表格：** 勾选，收缩表格，不能直接浏览数据；不勾选，不收缩表格，直接浏览数据。
  
  **支持回车换行：** 勾选，输出报告时遇到回车进行换行；不勾选，遇到回车不换行。

  **解析公式：** 指定是否解析报告中的公式；

 
**3) 页眉与页脚页**

  **顶部：** 定义报告页眉HTML语句；

  **底部：** 定义报告页脚HTML语句；

**4) 代码片断页**

  **Header：** 定义嵌入在报告顶部的Script语句；

  **Body：** 定义嵌入在Body开始位置的Script语句；

  **Footer：** 定义嵌入在报告底部的Script语句；


浏览报告浏览器
-----------------

浏览报告节点的浏览器，支持输出将报告另存为Html、doc、docx和pdf文件的功能。

多级报告整体排版
-----------------
  HTML报告是Datist 的最常见的输出格式之一，一般认为报告的组织包含递进与包罗两种关系。递进，即段落与段落之间的并列先后关系；而包罗则是指各级标题之间的层级关系，一级标题下的二级标题等。Datist中递进关系由二维表中的记录顺序来确定；包罗关系由节点的先后关系来确定；报告节点中可将输出报告流格式设置成Html-Tag，意为报告组件，即当前的输出物视为整个报告的一部分。如三级标题中的一段内容。可以设置输出标题的级别，以便于系统对报告组件进行层级编辑，文件收集器可以把报告组件的内容向后扭转，与其他的报告组件或报告内容共同组件一份完整的报告。

  **多级报告编号样式设置** 
  在流程属性窗口的标题样式页中，您可以选取系统预设的样式，或自定义自己的编号样式。
  
  您可以设置开始编号的数值；在编号样式中，选取特定级别编号的输出样式；在标题格式中，定义多级标题之间的连接关系。
  
  .. figure:: images/NodeHtmlReport_1.png
     :align: center
     :figwidth: 100% 
     :name: plate    
